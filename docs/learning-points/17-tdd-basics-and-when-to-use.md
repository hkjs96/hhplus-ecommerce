# TDD 정리: 언제 쓰고, 언제 안 쓰나(현실 기준)

> 목적: “TDD를 아는가?”를 면접/리뷰에서 답할 수 있도록, 과도한 이상론이 아닌 실무 기준으로 정리한다.

---

## 1) TDD 한 줄 정의

**TDD(Test-Driven Development)**는 “테스트를 먼저 쓰는 것”이 아니라,  
**작은 실패(RED) → 최소 구현(GREEN) → 리팩터(REFACTOR)** 사이클로 설계를 개선해 가는 개발 방식입니다.

---

## 2) RED → GREEN → REFACTOR

### RED (실패하는 테스트)
- 요구사항을 가장 작은 단위의 “행동”으로 표현
- 실패 이유가 명확해야 함(컴파일 실패/Assertion 실패 등)

### GREEN (최소 구현)
- 테스트를 통과시키는 **가장 단순한 구현**
- 이 단계에서 “깔끔함”을 과도하게 욕심내지 않는다

### REFACTOR (중복 제거/구조 개선)
- 중복 제거, 의도 드러내기, 책임 분리 등
- 테스트가 안전망이 되어 리팩터가 쉬워짐

---

## 3) TDD가 특히 잘 맞는 영역

- **도메인 규칙/계산 로직**: 할인 계산, 상태 전이, 검증 규칙처럼 순수 로직이 많은 곳
- **버그 재현 후 회귀 방지**: “이 입력에서 이 문제가 난다”를 테스트로 박제
- **API/DB가 아닌 핵심 알고리즘**: 외부 의존성이 적을수록 TDD 효율이 올라감

---

## 4) TDD가 비효율적인(또는 비용이 큰) 영역

- **UI/문서/스펙이 계속 바뀌는 초기 단계**
- **프레임워크 설정/인프라 연동**(Kafka/Redis/컨테이너 등): 테스트 셋업이 무거워 사이클이 느려짐
- **통합 테스트가 필수인 요구사항**(동시성/락/트랜잭션 타이밍): 단위 테스트만으로는 신뢰도가 낮음

이 경우에는 “TDD를 포기”가 아니라,
- 단위 테스트(TDD)로 보호할 수 있는 **순수 로직 부분만 분리**하고
- 나머지는 **통합 테스트(증빙)**로 검증하는 혼합 전략이 현실적입니다.

---

## 5) 이 레포 기준의 적용 감각

이 프로젝트는 Testcontainers 기반 통합 테스트(MySQL/Redis)를 중요 증빙으로 사용합니다.  
그래서 아래처럼 접근하면 TDD를 “과제/실무” 모두에 맞게 사용할 수 있습니다.

1. **도메인/유스케이스의 순수 규칙은 TDD로 빠르게**(RED-GREEN-REFACTOR)
2. **동시성/트랜잭션/이벤트(AFTER_COMMIT) 같은 부분은 통합 테스트로**(환경 기반)
3. “깨졌던 문제”는 테스트로 남겨 회귀를 막는다(버그픽스형 TDD)

---

## 6) 체크리스트 답변용 요약(3줄)

1. TDD는 “테스트 먼저”가 아니라 **RED→GREEN→REFACTOR로 설계를 개선**하는 루프다.  
2. 순수 로직/규칙에는 매우 효과적이고, 인프라 연동/통합 이슈는 비용이 커서 혼합 전략이 현실적이다.  
3. 이 레포에서는 도메인 규칙은 단위 테스트로, 동시성/트랜잭션은 통합 테스트로 증빙하는 방향이 맞다.

